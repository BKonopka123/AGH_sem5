SELECT c.czytelnik_id, COUNT(DISTINCT k.ksiazka_id) AS ilosc_wypozyczonych_ksiazek FROM czytelnik c JOIN wypozyczenie w ON c.czytelnik_id = w.czytelnik_id JOIN wc ON w.wypozyczenie_id = wc.wypozyczenie_id JOIN ksiazki k ON wc.ksiazka_id = k.ksiazka_id GROUP BY c.czytelnik_id
SELECT k.ksiazka_id, k.tytul, COUNT(DISTINCT c.czytelnik_id) AS ilosc_czytelnikow FROM ksiazki k JOIN wc ON k.ksiazka_id = wc.ksiazka_id JOIN wypozyczenie w ON wc.wypozyczenie_id = w.wypozyczenie_id JOIN czytelnik c ON w.czytelnik_id = c.czytelnik_id GROUP BY k.ksiazka_id, k.tytul HAVING COUNT(DISTINCT c.czytelnik_id) > 1